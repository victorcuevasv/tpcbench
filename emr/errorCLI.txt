Error Type	EXTERNAL
Error Code	HIVE_CANNOT_OPEN_SPLIT (16777219)
Stack Trace

com.facebook.presto.spi.PrestoException: Error opening Hive split s3a://tpcds-warehouse-emr-presto-10gb/store_returns/20190511_213454_00084_vtt3a_544997cf-b58f-4b5c-a7da-7ec49267a24a (offset=33554432, length=10088931): Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
	at com.facebook.presto.hive.parquet.ParquetPageSourceFactory.createParquetPageSource(ParquetPageSourceFactory.java:216)
	at com.facebook.presto.hive.parquet.ParquetPageSourceFactory.createPageSource(ParquetPageSourceFactory.java:115)
	at com.facebook.presto.hive.HivePageSourceProvider.createHivePageSource(HivePageSourceProvider.java:161)
	at com.facebook.presto.hive.HivePageSourceProvider.createPageSource(HivePageSourceProvider.java:95)
	at com.facebook.presto.spi.connector.classloader.ClassLoaderSafeConnectorPageSourceProvider.createPageSource(ClassLoaderSafeConnectorPageSourceProvider.java:44)
	at com.facebook.presto.split.PageSourceManager.createPageSource(PageSourceManager.java:56)
	at com.facebook.presto.operator.ScanFilterAndProjectOperator.getOutput(ScanFilterAndProjectOperator.java:218)
	at com.facebook.presto.operator.Driver.processInternal(Driver.java:379)
	at com.facebook.presto.operator.Driver.lambda$processFor$8(Driver.java:283)
	at com.facebook.presto.operator.Driver.tryWithLock(Driver.java:675)
	at com.facebook.presto.operator.Driver.processFor(Driver.java:276)
	at com.facebook.presto.execution.SqlTaskExecution$DriverSplitRunner.processFor(SqlTaskExecution.java:1065)
	at com.facebook.presto.execution.executor.PrioritizedSplitRunner.process(PrioritizedSplitRunner.java:162)
	at com.facebook.presto.execution.executor.TaskExecutor$TaskRunner.run(TaskExecutor.java:483)
	at com.facebook.presto.$gen.Presto_0_215____20190511_211655_1.run(Unknown Source)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleRetryableException(AmazonHttpClient.java:1175)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1121)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:770)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:744)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:726)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:686)
	at com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:668)
	at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:532)
	at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:512)
	at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4914)
	at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4860)
	at com.amazonaws.services.s3.AmazonS3Client.getObject(AmazonS3Client.java:1467)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.lambda$openStream$1(PrestoS3FileSystem.java:923)
	at com.facebook.presto.hive.RetryDriver.run(RetryDriver.java:139)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.openStream(PrestoS3FileSystem.java:920)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.openStream(PrestoS3FileSystem.java:905)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.seekStream(PrestoS3FileSystem.java:898)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.lambda$read$0(PrestoS3FileSystem.java:836)
	at com.facebook.presto.hive.RetryDriver.run(RetryDriver.java:139)
	at com.facebook.presto.hive.s3.PrestoS3FileSystem$PrestoS3InputStream.read(PrestoS3FileSystem.java:835)
	at java.io.BufferedInputStream.fill(BufferedInputStream.java:246)
	at java.io.BufferedInputStream.read(BufferedInputStream.java:265)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at com.facebook.presto.parquet.reader.MetadataReader.readIntLittleEndian(MetadataReader.java:294)
	at com.facebook.presto.parquet.reader.MetadataReader.readFooter(MetadataReader.java:89)
	at com.facebook.presto.hive.parquet.ParquetPageSourceFactory.createParquetPageSource(ParquetPageSourceFactory.java:152)
	... 17 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
	Caused by: java.net.UnknownHostException: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		at java.net.InetAddress.getAllByName0(InetAddress.java:1281)
		at java.net.InetAddress.getAllByName(InetAddress.java:1193)
		at java.net.InetAddress.getAllByName(InetAddress.java:1127)
		at com.amazonaws.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:27)
		at com.amazonaws.http.DelegatingDnsResolver.resolve(DelegatingDnsResolver.java:38)
		at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:112)
		at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
		at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
		at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
		at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
		at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
		at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
		at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
		at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
		... 42 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
	Caused by: java.net.UnknownHostException: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		at java.net.InetAddress.getAllByName0(InetAddress.java:1281)
		at java.net.InetAddress.getAllByName(InetAddress.java:1193)
		at java.net.InetAddress.getAllByName(InetAddress.java:1127)
		at com.amazonaws.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:27)
		at com.amazonaws.http.DelegatingDnsResolver.resolve(DelegatingDnsResolver.java:38)
		at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:112)
		at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
		at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
		at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
		at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
		at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
		at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
		at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
		at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
		... 42 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
	Caused by: java.net.UnknownHostException: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		at java.net.InetAddress.getAllByName0(InetAddress.java:1281)
		at java.net.InetAddress.getAllByName(InetAddress.java:1193)
		at java.net.InetAddress.getAllByName(InetAddress.java:1127)
		at com.amazonaws.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:27)
		at com.amazonaws.http.DelegatingDnsResolver.resolve(DelegatingDnsResolver.java:38)
		at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:112)
		at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
		at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
		at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
		at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
		at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
		at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
		at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
		at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
		... 42 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
	Caused by: java.net.UnknownHostException: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		at java.net.InetAddress.getAllByName0(InetAddress.java:1281)
		at java.net.InetAddress.getAllByName(InetAddress.java:1193)
		at java.net.InetAddress.getAllByName(InetAddress.java:1127)
		at com.amazonaws.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:27)
		at com.amazonaws.http.DelegatingDnsResolver.resolve(DelegatingDnsResolver.java:38)
		at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:112)
		at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
		at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
		at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
		at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
		at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
		at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
		at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
		at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
		... 42 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
	Caused by: java.net.UnknownHostException: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		at java.net.InetAddress.getAllByName0(InetAddress.java:1281)
		at java.net.InetAddress.getAllByName(InetAddress.java:1193)
		at java.net.InetAddress.getAllByName(InetAddress.java:1127)
		at com.amazonaws.SystemDefaultDnsResolver.resolve(SystemDefaultDnsResolver.java:27)
		at com.amazonaws.http.DelegatingDnsResolver.resolve(DelegatingDnsResolver.java:38)
		at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:112)
		at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
		at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
		at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
		at java.lang.reflect.Method.invoke(Method.java:498)
		at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
		at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
		at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
		at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
		at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
		at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
		at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
		at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
		at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
		... 42 more
	Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: tpcds-warehouse-emr-presto-10gb.s3.us-west-2.amazonaws.com
		... 44 more
		Suppressed: com.amazonaws.SdkClientException: Unable to execute HTTP request: Too many open files
			... 44 more
		Caused by: java.net.SocketException: Too many open files
			at java.net.Socket.createImpl(Socket.java:460)
			at java.net.Socket.getImpl(Socket.java:520)
			at java.net.Socket.setSoTimeout(Socket.java:1141)
			at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:120)
			at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
			at sun.reflect.GeneratedMethodAccessor399.invoke(Unknown Source)
			at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
			at java.lang.reflect.Method.invoke(Method.java:498)
			at com.amazonaws.http.conn.ClientConnectionManagerFactory$Handler.invoke(ClientConnectionManagerFactory.java:76)
			at com.amazonaws.http.conn.$Proxy153.connect(Unknown Source)
			at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:381)
			at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
			at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
			at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
			at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
			at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
			at com.amazonaws.http.apache.client.impl.SdkHttpClient.execute(SdkHttpClient.java:72)
			at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1297)
			at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1113)
			... 42 more
			
			
			